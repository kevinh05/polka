{"ast":null,"code":"import { combineLatest, map, of, switchMap } from 'rxjs';\nimport { memo } from '../util/index.js';\nexport function nextElected(instanceId, api) {\n  return memo(instanceId, () =>\n  // Compatibility for future generation changes in staking.\n  api.query.staking.erasStakersPaged ? api.derive.session.indexes().pipe(\n  // only populate for next era in the last session, so track both here - entries are not\n  // subscriptions, so we need a trigger - currentIndex acts as that trigger to refresh\n  switchMap(({\n    currentEra\n  }) => api.query.staking.erasStakersPaged.keys(currentEra)),\n  // Dedupe any duplicates\n  map(keys => [...new Set(keys.map(({\n    args: [, accountId]\n  }) => accountId.toString()))].map(a => api.registry.createType('AccountId', a)))) : api.query.staking.erasStakers ? api.derive.session.indexes().pipe(\n  // only populate for next era in the last session, so track both here - entries are not\n  // subscriptions, so we need a trigger - currentIndex acts as that trigger to refresh\n  switchMap(({\n    currentEra\n  }) => api.query.staking.erasStakers.keys(currentEra)),\n  // Dedupe any duplicates\n  map(keys => [...new Set(keys.map(({\n    args: [, accountId]\n  }) => accountId.toString()))].map(a => api.registry.createType('AccountId', a)))) : api.query.staking['currentElected']());\n}\n/**\n * @description Retrieve latest list of validators\n */\nexport function validators(instanceId, api) {\n  return memo(instanceId, () =>\n  // Sadly the node-template is (for some obscure reason) not comprehensive, so while the derive works\n  // in all actual real-world deployed chains, it does create some confusion for limited template chains\n  combineLatest([api.query.session ? api.query.session.validators() : of([]), api.query.staking ? api.derive.staking.nextElected() : of([])]).pipe(map(([validators, nextElected]) => ({\n    nextElected: nextElected.length ? nextElected : validators,\n    validators\n  }))));\n}","map":{"version":3,"names":["combineLatest","map","of","switchMap","memo","nextElected","instanceId","api","query","staking","erasStakersPaged","derive","session","indexes","pipe","currentEra","keys","Set","args","accountId","toString","a","registry","createType","erasStakers","validators","length"],"sources":["C:/Users/khyy4/Documents/Code-Projects/polkahack/pookey/node_modules/@polkadot/api-derive/staking/validators.js"],"sourcesContent":["import { combineLatest, map, of, switchMap } from 'rxjs';\nimport { memo } from '../util/index.js';\nexport function nextElected(instanceId, api) {\n    return memo(instanceId, () => \n    // Compatibility for future generation changes in staking.\n    api.query.staking.erasStakersPaged\n        ? api.derive.session.indexes().pipe(\n        // only populate for next era in the last session, so track both here - entries are not\n        // subscriptions, so we need a trigger - currentIndex acts as that trigger to refresh\n        switchMap(({ currentEra }) => api.query.staking.erasStakersPaged.keys(currentEra)), \n        // Dedupe any duplicates\n        map((keys) => [...new Set(keys.map(({ args: [, accountId] }) => accountId.toString()))].map((a) => api.registry.createType('AccountId', a))))\n        : api.query.staking.erasStakers\n            ? api.derive.session.indexes().pipe(\n            // only populate for next era in the last session, so track both here - entries are not\n            // subscriptions, so we need a trigger - currentIndex acts as that trigger to refresh\n            switchMap(({ currentEra }) => api.query.staking.erasStakers.keys(currentEra)), \n            // Dedupe any duplicates\n            map((keys) => [...new Set(keys.map(({ args: [, accountId] }) => accountId.toString()))].map((a) => api.registry.createType('AccountId', a))))\n            : api.query.staking['currentElected']());\n}\n/**\n * @description Retrieve latest list of validators\n */\nexport function validators(instanceId, api) {\n    return memo(instanceId, () => \n    // Sadly the node-template is (for some obscure reason) not comprehensive, so while the derive works\n    // in all actual real-world deployed chains, it does create some confusion for limited template chains\n    combineLatest([\n        api.query.session\n            ? api.query.session.validators()\n            : of([]),\n        api.query.staking\n            ? api.derive.staking.nextElected()\n            : of([])\n    ]).pipe(map(([validators, nextElected]) => ({\n        nextElected: nextElected.length\n            ? nextElected\n            : validators,\n        validators\n    }))));\n}\n"],"mappings":"AAAA,SAASA,aAAa,EAAEC,GAAG,EAAEC,EAAE,EAAEC,SAAS,QAAQ,MAAM;AACxD,SAASC,IAAI,QAAQ,kBAAkB;AACvC,OAAO,SAASC,WAAWA,CAACC,UAAU,EAAEC,GAAG,EAAE;EACzC,OAAOH,IAAI,CAACE,UAAU,EAAE;EACxB;EACAC,GAAG,CAACC,KAAK,CAACC,OAAO,CAACC,gBAAgB,GAC5BH,GAAG,CAACI,MAAM,CAACC,OAAO,CAACC,OAAO,CAAC,CAAC,CAACC,IAAI;EACnC;EACA;EACAX,SAAS,CAAC,CAAC;IAAEY;EAAW,CAAC,KAAKR,GAAG,CAACC,KAAK,CAACC,OAAO,CAACC,gBAAgB,CAACM,IAAI,CAACD,UAAU,CAAC,CAAC;EAClF;EACAd,GAAG,CAAEe,IAAI,IAAK,CAAC,GAAG,IAAIC,GAAG,CAACD,IAAI,CAACf,GAAG,CAAC,CAAC;IAAEiB,IAAI,EAAE,GAAGC,SAAS;EAAE,CAAC,KAAKA,SAAS,CAACC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,CAACnB,GAAG,CAAEoB,CAAC,IAAKd,GAAG,CAACe,QAAQ,CAACC,UAAU,CAAC,WAAW,EAAEF,CAAC,CAAC,CAAC,CAAC,CAAC,GAC3Id,GAAG,CAACC,KAAK,CAACC,OAAO,CAACe,WAAW,GACzBjB,GAAG,CAACI,MAAM,CAACC,OAAO,CAACC,OAAO,CAAC,CAAC,CAACC,IAAI;EACnC;EACA;EACAX,SAAS,CAAC,CAAC;IAAEY;EAAW,CAAC,KAAKR,GAAG,CAACC,KAAK,CAACC,OAAO,CAACe,WAAW,CAACR,IAAI,CAACD,UAAU,CAAC,CAAC;EAC7E;EACAd,GAAG,CAAEe,IAAI,IAAK,CAAC,GAAG,IAAIC,GAAG,CAACD,IAAI,CAACf,GAAG,CAAC,CAAC;IAAEiB,IAAI,EAAE,GAAGC,SAAS;EAAE,CAAC,KAAKA,SAAS,CAACC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,CAACnB,GAAG,CAAEoB,CAAC,IAAKd,GAAG,CAACe,QAAQ,CAACC,UAAU,CAAC,WAAW,EAAEF,CAAC,CAAC,CAAC,CAAC,CAAC,GAC3Id,GAAG,CAACC,KAAK,CAACC,OAAO,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC;AACpD;AACA;AACA;AACA;AACA,OAAO,SAASgB,UAAUA,CAACnB,UAAU,EAAEC,GAAG,EAAE;EACxC,OAAOH,IAAI,CAACE,UAAU,EAAE;EACxB;EACA;EACAN,aAAa,CAAC,CACVO,GAAG,CAACC,KAAK,CAACI,OAAO,GACXL,GAAG,CAACC,KAAK,CAACI,OAAO,CAACa,UAAU,CAAC,CAAC,GAC9BvB,EAAE,CAAC,EAAE,CAAC,EACZK,GAAG,CAACC,KAAK,CAACC,OAAO,GACXF,GAAG,CAACI,MAAM,CAACF,OAAO,CAACJ,WAAW,CAAC,CAAC,GAChCH,EAAE,CAAC,EAAE,CAAC,CACf,CAAC,CAACY,IAAI,CAACb,GAAG,CAAC,CAAC,CAACwB,UAAU,EAAEpB,WAAW,CAAC,MAAM;IACxCA,WAAW,EAAEA,WAAW,CAACqB,MAAM,GACzBrB,WAAW,GACXoB,UAAU;IAChBA;EACJ,CAAC,CAAC,CAAC,CAAC,CAAC;AACT","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}